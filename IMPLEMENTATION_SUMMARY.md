# üìã –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π Whisper

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ **–ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–µ–π Whisper** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —Å–∫–∞—á–∏–≤–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –º–æ–¥–µ–ª—å.

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü–æ—Ç–æ–∫ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:

```
–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    ‚Üì
[Backend] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    ‚Üì
[Backend] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ WHISPER_MODELS_DIR env –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    ‚Üì
[Backend] –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –º–æ–¥–µ–ª–∏ base
    ‚îú‚îÄ –ï—Å–ª–∏ –µ—Å—Ç—å ‚Üí –ø—Ä–æ–ø—É—Å–∫
    ‚îî‚îÄ –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –∑–∞–ø—É—Å–∫ –∑–∞–≥—Ä—É–∑–∫–∏ —Å HuggingFace
    ‚Üì
[Frontend] –≠–∫—Ä–∞–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å
    ‚Üì
[Backend] –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ ‚Üí –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Whisper
    ‚Üì
[Frontend] –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

### –•—Ä–∞–Ω–∏–ª–∏—â–µ –º–æ–¥–µ–ª–µ–π:

- **Windows**: `%AppData%/voice-input-app/whisper_models/`
- **macOS**: `~/Library/Application Support/voice-input-app/whisper_models/`
- **Linux**: `~/.config/voice-input-app/whisper_models/`

(–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —á–µ—Ä–µ–∑ `WHISPER_MODELS_DIR` env)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. **Backend (Rust)**

#### `src-tauri/Cargo.toml`
```toml
[–¥–æ–±–∞–≤–ª–µ–Ω–æ]
tokio = { features = ["fs", "io-util"] }  # –î–ª—è async —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
reqwest = { features = ["rustls-tls", "stream"] }  # –î–ª—è HTTP –∑–∞–≥—Ä—É–∑–∫–∏
futures-util = "0.3"  # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ—Ç–æ–∫–∞–º–∏
```

#### `src-tauri/src/utils/setup.rs` (–æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)
```rust
pub fn get_models_dir(app_handle: &AppHandle) -> Result<PathBuf, AppError>
// –ü–æ–ª—É—á–∞–µ—Ç –ø–∞–ø–∫—É –º–æ–¥–µ–ª–µ–π –∏–∑ AppData (–∏–ª–∏ env WHISPER_MODELS_DIR)

pub async fn download_model(app_handle: &AppHandle, model_name: &str) -> Result<PathBuf, AppError>
// –°–∫–∞—á–∏–≤–∞–µ—Ç –º–æ–¥–µ–ª—å —Å HuggingFace –≤ AppData —Å –ø–æ—Ç–æ–∫–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π

pub async fn ensure_default_model(app_handle: &AppHandle) -> Result<(), AppError>
// –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç base –º–æ–¥–µ–ª—å –µ—Å–ª–∏ –Ω—É–∂–Ω–∞

pub fn ensure_models_dir_env(app_handle: &AppHandle) -> Result<PathBuf, AppError>
// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç WHISPER_MODELS_DIR env –¥–ª—è –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –†–µ–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ reqwest —Å –ø–æ—Ç–æ–∫–æ–º (streaming)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π (–º–æ–¥–µ–ª—å —É–∂–µ —Å–∫–∞—á–∞–Ω–∞?)
- ‚úÖ Env –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ –ø—É—Ç–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `SKIP_MODEL_DOWNLOAD` –¥–ª—è offline —Ä–µ–∂–∏–º–∞

#### `src-tauri/src/commands/setup.rs`
```rust
pub async fn initialize_app(app_handle: tauri::AppHandle) -> Result<SetupStatus, String>
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å—é —Å–∏—Å—Ç–µ–º—É (–¥–∏—Ä, env, –∑–∞–≥—Ä—É–∑–∫–∞, —Å—Ç–∞—Ç—É—Å)
```

#### `src-tauri/src/main.rs` (–ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
```rust
// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:
1. init_models_dir()           // –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫–æ—Ä–∏—é
2. ensure_models_dir_env()     // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å env
3. ensure_default_model()      // –°–∫–∞—á–∞—Ç—å –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
4. whisper::init(ModelSize::Base)  // –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ –ø–∞–º—è—Ç—å
```

#### `src-tauri/src/recognition/models.rs`
```rust
pub fn get_model_path(model_size: ModelSize) -> Result<PathBuf, String>
// –¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç WHISPER_MODELS_DIR env –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å
```

### 2. **Frontend (React/TypeScript)**

#### `src/hooks/useInitialization.tsx`
```typescript
useInitialization()
// –£–∂–µ –≥–æ—Ç–æ–≤–æ–π hook –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
// –í—ã–∑—ã–≤–∞–µ—Ç initialize_app –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å
```

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:
- Spinning loader –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å –∫–Ω–æ–ø–∫–æ–π retry –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

### 3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**

–û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|-----------|
| [README.md](README.md) | –û–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏, –ø—É—Ç–∏ –º–æ–¥–µ–ª–µ–π |
| [docs/WHISPER_MODELS.md](docs/WHISPER_MODELS.md) | "–í–∞—Ä–∏–∞–Ω—Ç 0: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ" |
| [docs/FAQ.md](docs/FAQ.md) | –û–±–Ω–æ–≤–ª–µ–Ω—ã –æ—Ç–≤–µ—Ç—ã –ø—Ä–æ "Model file not found" |
| [docs/INSTALLATION.md](docs/INSTALLATION.md) | –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ |
| [WHISPER_SETUP.md](WHISPER_SETUP.md) | –û–±–Ω–æ–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã, —É–±—Ä–∞–Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ä—É—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ |

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
# –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å - –º–æ–¥–µ–ª—å —Å–∫–∞—á–∞–µ—Ç—Å—è —Å–∞–º–∞
npm run tauri dev

# –ò–ª–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
npm run tauri build
```

**–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:**
- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ (2-5 –º–∏–Ω—É—Ç)
- –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ base (141 MB)
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—É—Ç—å –∫ –º–æ–¥–µ–ª—è–º:**
```bash
WHISPER_MODELS_DIR=/opt/models npm run tauri dev
```

**–û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É (–µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å):**
```bash
SKIP_MODEL_DOWNLOAD=1 npm run tauri dev
```

**–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∑–∞–≥—Ä—É–∑–∫–∏:**
```bash
RUST_LOG=debug npm run tauri dev
```

---

## üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### –ö–æ–º–ø–∏–ª—è—Ü–∏—è
‚úÖ –í—Å–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è (—Ç–æ–ª—å–∫–æ 5 warnings –æ –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ)

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- ‚úÖ –ü–æ—Ç–æ–∫–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤–µ—Å—å —Ñ–∞–π–ª –≤ –ø–∞–º—è—Ç–∏)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ AppData (–º—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ)
- ‚úÖ Env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏
- ‚úÖ Fallback –Ω–∞ project `models/` –µ—Å–ª–∏ –µ—Å—Ç—å
- ‚úÖ Frontend —ç–∫—Ä–∞–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π
- ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- ‚úÖ FAQ –æ–±–Ω–æ–≤–ª–µ–Ω

---

## üéØ –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è production –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

1. **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∑–∞–≥—Ä—É–∑–∫–∏** ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å % –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ "Loading"
   - –¢—Ä–µ–±—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ progress events –∏–∑ backend
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `tauri::Emitter::emit()`

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏** ‚Äî SHA256 —Ö–µ—à-—Å—É–º–º–∞ —Å–∫–∞—á–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
   - –î–æ–±–∞–≤–∏—Ç—å –≤ `MODEL_URLS` –∫–æ—Ä—Ç–µ–∂–∏ —Å —Ö–µ—à–∞–º–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏

3. **–û—Ç–º–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏** ‚Äî –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ—á–µ—Ç –≤—ã–π—Ç–∏
   - –ò—Å–ø–æ–ª—å–∑—É—è `tokio::sync::CancellationToken`

4. **UI –¥–ª—è –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏** ‚Äî –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –ö–Ω–æ–ø–∫–∞ "Download medium model" –∏ —Ç.–¥.
   - –£–∂–µ –≥–æ—Ç–æ–≤ backend –∫ —ç—Ç–æ–º—É

---

## ‚ú® –ò—Ç–æ–≥–æ

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è:**
- –°–∫–∞—á–∏–≤–∞–µ—Ç –º–æ–¥–µ–ª—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ ‚úÖ
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é AppData ‚úÖ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ç–æ–∫–æ–≤—É—é –∑–∞–≥—Ä—É–∑–∫—É ‚úÖ
- –ö—ç—à–∏—Ä—É–µ—Ç –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—É—Å–∫–æ–≤ ‚úÖ
- –ò–º–µ–µ—Ç fallback –Ω–∞ project `models/` –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ‚úÖ
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ ‚úÖ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ‚úÖ
- –ü–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ ‚úÖ

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ:**
- ~~–°–∫–∞—á–∏–≤–∞—Ç—å –º–æ–¥–µ–ª—å –≤—Ä—É—á–Ω—É—é~~ ‚úÖ
- ~~–ü–æ–Ω–∏–º–∞—Ç—å –≥–¥–µ –µ—ë –ø–æ–ª–æ–∂–∏—Ç—å~~ ‚úÖ
- ~~–£—Å—Ç—Ä–∞–Ω—è—Ç—å –æ—à–∏–±–∫–∏ "Model file not found"~~ ‚úÖ
